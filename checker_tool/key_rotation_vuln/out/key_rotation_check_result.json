{
  "ok": false,
  "failures": [
    {
      "code": "K-A1",
      "title": "jwks_uri missing",
      "detail": "Discovery에 jwks_uri가 없어 키 출처를 고정할 수 없음.",
      "evidence": {
        "discovery": {
          "issuer": null,
          "jwks_uri": null
        }
      }
    },
    {
      "code": "K-A3",
      "title": "JWKS empty",
      "detail": "JWKS에 키가 없음.",
      "evidence": {
        "jwks": {
          "keys": []
        }
      }
    },
    {
      "code": "K-B4",
      "title": "id_token의 kid가 JWKS에 없음",
      "detail": "재조회 후에도 없으면 fail-closed.",
      "evidence": {
        "kid": "0T-gnXeKbsLJgXWpBj9TRba00ALG3jb1qeXjThbmf_Q"
      }
    },
    {
      "code": "K-B4",
      "title": "access_token의 kid가 JWKS에 없음",
      "detail": "재조회 후에도 없으면 fail-closed.",
      "evidence": {
        "kid": "0T-gnXeKbsLJgXWpBj9TRba00ALG3jb1qeXjThbmf_Q"
      }
    }
  ],
  "warnings": [],
  "observed": {
    "issuer": null,
    "jwks_uri": null,
    "allowed_algs": [
      "ES256",
      "ES384",
      "ES512",
      "EdDSA",
      "PS256",
      "PS384",
      "PS512",
      "RS256",
      "RS384",
      "RS512"
    ]
  },
  "checklist": {
    "A": {
      "jwks_uri_https": {
        "result": "Fail",
        "observed": {
          "jwks_uri": null
        }
      },
      "issuer_host_matches_jwks_uri": {
        "result": "N/A",
        "observed": {
          "issuer": null,
          "jwks_uri": null
        }
      },
      "jwks_has_keys": {
        "result": "Fail",
        "observed": {
          "keys_count": 0
        }
      },
      "jwks_duplicate_kid": {
        "result": "N/A",
        "observed": {
          "dupe_kids": {}
        }
      },
      "jwks_use_keyops": {
        "result": "Pass",
        "observed": {
          "use_missing_kids": []
        }
      },
      "no_external_header_refs": {
        "result": "Pass",
        "observed": {
          "external_header_fields": {}
        }
      }
    },
    "B": {
      "pin_issuer_jwks_uri": {
        "result": "N/A",
        "observed": {
          "issuer": null,
          "jwks_uri": null
        }
      },
      "alg_whitelist_id_token": {
        "result": "Pass",
        "observed": {
          "alg": "RS256"
        }
      },
      "alg_whitelist_access_token": {
        "result": "Pass",
        "observed": {
          "alg": "RS256"
        }
      },
      "alg_whitelist_client_assertion": {
        "result": "N/A",
        "observed": null
      },
      "kid_present_id_token": {
        "result": "Pass"
      },
      "kid_known_id_token": {
        "result": "Fail",
        "observed": {
          "kid": "0T-gnXeKbsLJgXWpBj9TRba00ALG3jb1qeXjThbmf_Q"
        }
      },
      "header_external_ref_id_token": {
        "result": "Pass"
      },
      "kid_pattern_id_token": {
        "result": "Pass"
      },
      "kid_present_access_token": {
        "result": "Pass"
      },
      "kid_known_access_token": {
        "result": "Fail",
        "observed": {
          "kid": "0T-gnXeKbsLJgXWpBj9TRba00ALG3jb1qeXjThbmf_Q"
        }
      },
      "header_external_ref_access_token": {
        "result": "Pass"
      },
      "kid_pattern_access_token": {
        "result": "Pass"
      },
      "kid_present_client_assertion": {
        "result": "N/A"
      },
      "registration_jwks_vs_jwks_uri": {
        "result": "N/A"
      }
    },
    "C": {
      "inject_unknown_kid": {
        "result": "Advisory",
        "note": "동작 테스트는 동적 환경 필요. 모듈은 unknown kid를 Fail로 판정."
      },
      "header_injection_fields_seen": {
        "result": "Pass",
        "observed": {
          "tokens_with_external_ref": []
        }
      },
      "hs_rs_switch": {
        "result": "Pass"
      },
      "kid_traversal": {
        "result": "Pass"
      }
    }
  }
}