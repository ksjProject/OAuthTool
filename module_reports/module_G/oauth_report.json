{
  "groups": {
    "5.0": {
      "overall": "PASS",
      "checks": [
        {
          "id": "5.0-QUERY-TOKEN",
          "title": "Query Token Leak",
          "description": "토큰이 URL 쿼리에 포함됨",
          "result": "PASS"
        },
        {
          "id": "5.0-REFERER-TOKEN",
          "title": "Referer Token Leak",
          "description": "Referer로 토큰 유출",
          "result": "PASS"
        }
      ]
    },
    "5.1": {
      "overall": "FAIL",
      "checks": [
        {
          "id": "5.1-QUERY-CLIENT-SECRET",
          "title": "Client Secret Query",
          "description": "client_secret이 URL 쿼리에 포함됨",
          "result": "PASS"
        },
        {
          "id": "5.1-REFERER-CLIENT-SECRET",
          "title": "Client Secret Referer",
          "description": "Referer로 client_secret 유출",
          "result": "PASS"
        },
        {
          "id": "5.1-TOKEN-BODY-SECRET",
          "title": "Token Body Secret",
          "description": "Token 요청에서 client_secret 전송 감지",
          "result": "FAIL",
          "severity": "HIGH",
          "evidence": "Token endpoint POST to https://happy.songsings.site/kc/realms/web-service/protocol/openid-connect/token\nbody snippet: grant_type=authorization_code&client_id=200-django&client_secret=KiolOZrdVwr5nr7jHYgrYK8j81qYJVfo&code=3f54ee7a-2cac-4b6b-952d-0fff7bb4ecfa.f27bee46-ba7b-446b-a5b4-d92fdfc007e0.5cb442f6-10c8-4630-b248-0bb859b42688&redirect_uri=http%3A%2F%2Fksj15.ddns.net%2Fdjango%2Faccounts%2Foidc%2Fcallback%2F",
          "recommendation": "토큰은 HTTP 헤더에 포함되어야 합니다.",
          "full_title": "Token 요청에서 client_secret 전송 감지"
        },
        {
          "id": "5.1-TOKEN-AUTH-BASIC",
          "title": "Token Auth Basic",
          "description": "Token 요청에서 Authorization: Basic 사용 감지",
          "result": "PASS"
        },
        {
          "id": "5.1-SESSION-TOKEN-SECRET",
          "title": "Session token secret",
          "description": "session_token.json에 client_secret 기록 감지",
          "result": "PASS"
        }
      ]
    },
    "5.3": {
      "overall": "PASS",
      "checks": [
        {
          "id": "5.3-STATE-MISSING",
          "title": "State Missing",
          "description": "Authorization 요청에 state 누락",
          "result": "PASS"
        },
        {
          "id": "5.3-STATE-LOW-ENTROPY",
          "title": "State Low Entropy",
          "description": "state 무작위성 부족",
          "result": "PASS"
        },
        {
          "id": "5.3-STATE-REUSE",
          "title": "State Reuse",
          "description": "state 재사용 감지",
          "result": "PASS"
        },
        {
          "id": "5.3-CB-STATE-MISSING",
          "title": "Callback State Missing",
          "description": "콜백에 state 누락",
          "result": "PASS"
        },
        {
          "id": "5.3-CB-STATE-MISMATCH",
          "title": "Callback State Mismatch",
          "description": "콜백 state 불일치(알 수 없음)",
          "result": "PASS"
        }
      ]
    },
    "5.5": {
      "overall": "FAIL",
      "checks": [
        {
          "id": "5.5-RISKY-SCOPE",
          "title": "Risky Scope",
          "description": "과도한/민감한 scope 요청",
          "result": "FAIL",
          "severity": "HIGH",
          "evidence": "Request URL: https://happy.songsings.site/kc/realms/web-service/protocol/openid-connect/auth?client_id=200-django&response_type=code&scope=openid+profile+email+offline_access&redirect_uri=http%3A%2F%2Fksj15.ddns.net%2Fdjango%2Faccounts%2Foidc%2Fcallback%2F&state=pAfXJ6B9SnjiuH6vMgodfUHNnBsSHcjpHSJR7IXDWdU\nRisk tokens: email, offline_access, profile\nRisk categories: OFFLINE, PRIVACY",
          "recommendation": "최소 권한 원칙을 적용하고, 민감 범위는 별도 동의 절차로 분리하세요.",
          "full_title": "과도한/민감한 scope 요청 (IDP-agnostic)"
        }
      ]
    }
  },
  "overall": "FAIL"
}
